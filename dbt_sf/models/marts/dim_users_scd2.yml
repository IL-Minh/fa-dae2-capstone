version: 2

models:
  - name: dim_users_scd2
    description: "SCD2 dimension model for users showing all historical versions from snapshot"
    config:
      tags: ["marts", "dimensions", "users", "scd2", "historical"]

    columns:
      - name: user_key
        description: "Unique surrogate key for each user version (includes snapshot version)"
        tests:
          - not_null
          - unique

      - name: user_id
        description: "Business key for user identification"

      - name: first_name
        description: "User's first name"

      - name: last_name
        description: "User's last name"

      - name: email
        description: "User's email address"

      - name: age
        description: "User's age"

      - name: age_group
        description: "Categorized age group"

      - name: income_bracket
        description: "User's income bracket category"

      - name: customer_tier
        description: "Customer tier classification"

      - name: risk_profile
        description: "User's risk profile assessment"

      - name: city
        description: "User's city"

      - name: state
        description: "User's state/province"

      - name: country
        description: "User's country"

      - name: region
        description: "Geographic region"

      - name: registration_date
        description: "Date when user registered"

      - name: preferred_categories
        description: "User's preferred transaction categories"

      - name: is_active
        description: "Whether the user account is active"

      - name: source_system
        description: "Source system identifier"

      - name: effective_date
        description: "When this version of the user record became effective"

      - name: end_date
        description: "When this version of the user record ended (null for current)"

      - name: is_current
        description: "Whether this is the current version of the user record"

      - name: dbt_updated_at
        description: "When dbt last updated this record"

      - name: dbt_scd_id
        description: "dbt snapshot change detection ID"

      - name: dbt_processed_at
        description: "When this model was last processed by dbt"
